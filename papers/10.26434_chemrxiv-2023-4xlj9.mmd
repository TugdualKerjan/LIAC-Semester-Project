###### Abstract

To obtain accurate enthalpies of formation of a chemical species, \(\Delta H_{\mathrm{f}}\), one needs a procedure to quantitatively connect the results from quantum mechanical (QM) calculations with the experimental enthalpies of elements in their standard state, often along with additional empirical corrections. Although QM methods continue to improve, accuracy gains from new methods are usually realized if the calculations for\(\Delta H_{\rm f}\) are properly corrected. One such approach is to use atomization energy corrections (AECs) followed by bond additivity corrections (BACs), such as those defined by Petersson et al. or Anantharaman and Melius. Another approach is to utilize isodesemic reactions (IDRs) which are error-canceling reactions that can be constructed systematically as shown by Buerger et al. In this work, we implement all of these approaches in Arkane, an open-source software that can calculate species thermochemistry from computations done by a wide variety of QM software packages. As part of this work, we curate a diverse database of over 400 reference species from the available literature for use in fitting BACs or to participate in IDRs, and also provide AECs and BACs for 15 commonly used levels of theory using the workflow implemented. When comparing the approaches, we find that both BAC types yield results of similar accuracy, though the Anantharaman and Melius-type BACs seem to generalize better. Further, although the IDRs approach is often as accurate as the BAC approaches and sometimes even more advantageous, we find that this method appears to be less robust than the BAC methods. In particular, the accuracy of the IDRs approach is sensitive to the chosen reference species and reactions. Therefore, in addition to providing the automated AECs and BACs fitting procedure, we also propose improved methods to select IDRs.

## 1 Introduction

Obtaining high-accuracy chemical species thermochemistry is essential to solve many important problems in chemistry. Experiments can provide high-accuracy results, often yielding data accuracy within 0.1 kcal/mol or better. However, usually several experiments need to be combined to obtain accurate thermochemical parameters reported in standard states. Moreover, many species (especially radicals, but not exclusively) cannot be isolated conveniently for experimentation. Due to the importance of these parameters, several databases exist that provide high-accuracy thermochemistry data. One widely used database is the Active Thermochemical Table (ATcT)[1, 2], which aims to produce a self-consistent set of species thermochemistry with continually improving accuracy. When data from ATcT or other high-quality experimental sources are available, they represent the preferred route for obtaining the most accurate thermochemical values of a species of interest. However, entries in ATcT represent only a minuscule fraction of all species of interest in the vast chemical universe. Given that experiments are often time-consuming, particularly if they require synthesizing the species of interest, computing species thermochemistry through quantum mechanical (QM) calculations can prove quite valuable.

As QM methods continue to improve, higher accuracy data can be obtained for larger and larger species. For example, the domain-based local pairwise natural orbital (DLPNO) coupled cluster (CC) methods [3, 4] promise to deliver CC accuracy of less than 1 kcal/mol for molecules much larger than what has previously been feasible with classical CC methods. However, to realize the accuracy gains, it is well-known that energy corrections are needed in addition to the QM calculations to reduce residual errors present from the given level of theory (LOT). Usually, atomization energy corrections (AECs) are needed to correct for the large systematic errors in the computed absolute energies of atoms, and to connect the computed zero of energy to the standard state zero of energy used when defining the enthalpy of formation (a.k.a. heats of formation) \(\Delta H_{\mathrm{f}}\). As we show later in this work, if no additional corrections are used, the resulting \(\Delta H_{\mathrm{f}}\) tends to have a fairly wide distribution of errors, often not centered around zero. The need for additional corrections is well-known, and in fact, such corrections have already been derived for some DLPNO methods [5].

There are several approaches to achieve quantum thermochemistry corrections beyond the AEC. Recently, delta machine learning (\(\Delta\)-ML) techniques have been applied to this type of problem [6]. However, while ML methods have gained popularity, they often lack the interpretability intrinsic to classic strategies. In this study, our emphasis will be placed on two conventional methods. The first approach involves the use of bond additivity corrections (BACs). BAC methods assume that the residual error from QM calculations can be attributed to errors associated with specific types of bonds within a molecule. Further, the errors associated with a particular type of bond (e.g., a C-C single bond) are assumed to be largely consistent across various molecules that contain the same bond type. Therefore, a correction value can be fitted for each bond type found in a collection of reference molecules, and the total bond additivity correction is simply the sum of these corrections for every bond in a species of interest. In this work, we focus on two popular implementations of BAC: those of Petersson et al. [7] and those of Anantharaman and Melius [8]. For brevity, below we call the Anantharaman & Melius' BAC's "Melius-type" or "m-BAC", although we note that Melius had success with several different types of BACs during his long career [9]. Similarly, we will denote Petersson's BAC as "Petersson-type" or "p-BAC".

A separate approach involves the use of isodesmic reactions (IDRs) [10, 11], where species participating in the reaction other than the species of interest, or the target species, are calculated at the same LOT but also have precisely known (e.g., experimental) enthalpies of formation. The IDRs approach has the advantage of being insensitive to the AECs since they cancel out when computing heats of reaction. The IDRs approach has been used to calculate accurate enthalpy of formation for large molecules such as C\({}_{60}\) and corannulene [12]. Recent breakthroughs have been made in this avenue, with the work of Buerger et al. [13] showing how isodesmic reactions can be found systematically and automatically rather than designing them by hand as has been done traditionally. This advancement allows IDRs to be used in high-throughput calculations when implemented in statistical mechanics or thermochemistry software.

One problem we have often encountered in practice is that the choice of reference species (a.k.a. the training set) used in the above-mentioned thermo-correction approaches can vary from study to study. This training set inconsistency can cause issues when BACs fitted to a small set of reference molecules are used for species that are not well represented by the original set (e.g., using BACs fitted to only neutral, closed-shell species for charged or open-shell species). The exact species set used in the fitting process is not always reported in literature, making it difficult to reproduce some previous work. Therefore, in our implementation of the classical thermo-correction methods for comparison, we concurrently address the training set issue by providing a curated, open-source reference species database.

In this work, we compute appropriate thermo-correction values and implement the calculation procedures for both p-type and m-type BAC approaches, along with IDRs approaches into the open-source statistical mechanics, kinetics, and thermochemistry software Arkane [14]. We also provide a curated database of reference species from the literature for fitting additional BAC values and for use in IDRs. We compare the thermo-correction approaches and also develop scripts for simplifying the process of adding new BACs for additional LOTs into Arkane. Finally, we provide new BAC values for 15 commonly used LOTs calculated using the workflow described here.

## 2 Theoretical Methods

### Reference Data

Enthalpy of formation data at 298 K for 421 chemical species are compiled from the available literature, including the Active Thermochemical Tables (ATcT) [15, 2, 1], National Institute of Standards and Technology Chemistry WebBook (NIST) [16], the Computer Analysis of Thermo Chemical data (CATCH) search and retrieval system of Pedley et al. [17], Third Millennium Ideal Gas and Condensed Phase Thermochemical Database (3rd Mil.) [18], the NIST Computational Chemistry Comparison and Benchmark Database (CCCBDB) [19], and the works from Cioslowski et al. [20] and Benson [21]. The selected species exhibit a wide variety of chemical features, including a diversity of elements, charges, and multiplicities, as summarized in Table 1. Most species are small molecules, and about 100 species have five or more heavy atoms, with the largest species being adamantane (C\({}_{10}\)H\({}_{16}\)).

In addition to encompassing a diverse range of chemical features, the species chosen all have very precisely known heats of formation. All species have an uncertainty (95% confidence interval based on ATcT) of 1 kJ/mol (0.3 kcal/mol) or less, with the exception of a few sulfur containing species. The average uncertainty is 0.63 kJ/mol (0.15 kcal/mol), and the largest uncertainty is 2.3 kJ/mol (0.55 kcal/mol) for tetramethylthiourea, a larger sulfur containing species. Therefore, by convention, all the species have gold-standard (uncertainty < 1 kcal/mol) thermochemistry.

The data is compiled into a database of reference species (henceforth referred to as the "reference database") located within the larger RMG-database [22], available on GitHub (link provided in SI). The reference database consists of YAML text files, one for each species, that contains information about the species structure (e.g., 3D coordinates and RMG adjacency list representation of the species) along with the heat of formation data from the literature. Some species have data from multiple sources, which are all included in the database, but by default the source with the lowest uncertainty is used for computations.

In addition to reference data derived from experiments, each YAML file stores calculated heats of formation (298 K, including calculated AECs) for various levels of theory, including those discussed in this work, with the plan of extending to additional LOTs in a subsequent publication. In this way, the YAML files contain enough information to fit and re-fit bond additivity corrections or to perform isodesmic reaction calculations using any of the species in the reference database.

\begin{table}
\begin{tabular}{l r r} \hline Property & Number of Species & Percent of Species [\%] \\ \hline Contains H & 350 & 83.1 \\ Contains C & 356 & 84.6 \\ Contains N & 98 & 23.2 \\ Contains O & 169 & 40.1 \\ Contains F & 39 & 9.3 \\ Contains S & 72 & 17.1 \\ Contains Cl & 42 & 10.0 \\ Contains Br & 15 & 3.6 \\ Anions & 24 & 5.7 \\ Cations & 11 & 2.6 \\ Zwitterions & 17 & 4.0 \\ Open-shell & 73 & 17.3 \\ \hline \end{tabular}
\end{table}
Table 1: Properties of Reference Species (N = 421)The YAML format is chosen as a way to store the data in a human-readable and writable manner while also allowing the data to be read in as native RMG objects in Python. Adding data to these files therefore can also be done using the RMG and Arkane API, which contains useful functions for common tasks such as adding in data from quantum chemistry calculations for a new level of theory.

### Quantum Chemistry Calculations

While there are many affordable quantum chemistry methods that can be used to calculate thermochemistry for large molecules, this work focuses on a subset of popular methods that span different levels of theory. In particular, we consider \(\omega\)B97M-V [23], \(\omega\)B97X-D [24], B3LYP-D3 [25], BP86 [26, 27], B97D3 [28], TPSS [29], PBE0 [30], M06-2X [31], CAM-B3LYP [32], B2PLYPD [33], G4 [34], and CBS-QB3 [35]. Additionally, the domain-based local pairwise natural orbital (DLPNO) coupled cluster methods are considered, specifically DLPNO-CCSD(T) [3] and DLPNO-CCSD(T)-F12 [4]. These methods are an approximation on traditional coupled cluster calculations that allow for a near-linear scaling in the coupled cluster iterations with minimal loss of accuracy. DLPNO methods promise to extend the gold standard chemical accuracy of coupled cluster methods to much larger molecules, as traditional coupled cluster methods usually become prohibitively expensive for even moderately sized molecules.

\(\omega\)B97M-V calculations are performed using QChem 5.2 [36] with the default grid and an SCF convergence tolerance of \(10^{-8}\). Calculations for composite methods and other DFTs are performed using Gaussian 16 [37] with tight settings for optimization and SCF convergence, along with an ultrafine grid. For B3LYP-D3 and B97D3, the empirical D3BJ [38] dispersion model in Gaussian is employed. Orca 4.2.1 [39, 40] is used for calculating single point energies with DLPNO-CCSD(T) and DLPNO-CCSD(T)-F12. Optimized geometries from \(\omega\)B97X-D and \(\omega\)B97M-V are used for DLPNO-CCSD(T) and DLPNO-CCSD(T)-F12, respectively. In all cases, a tightSCF convergence along with tightPNO tolerances for DLPNO approximations are used. For DLPNO-CCSD(T), def2-TZVP is used as the basis set with a def2TZVP/c auxillary basis set. For DLPNO-CCSD(T)-F12, cc-pVTZ-F12 is used as the basis set with an aug-cc-pVTZ/c auxillary basis sets and a cc-pVTZ-F12-CABS complimentary auxillary basis set. Additional DLPNO-CCSD(T)-F12 calculatons are performed using the smaller cc-pVDZ-F12 basis and the aug-cc-pVDZ/c auxillary basis sets and a cc-pVDZ-F12-CABS complimentary auxillary basis set. uHF is used for open-shell species such as radicals, and rHF for closed-shell species. The full list of methods used is presented in Table 2.

### Statistical Mechanics Calculations

Heats of formation are calculated from single point energies and scaled[41] vibrational frequencies via Arkane[14] using the rigid rotor harmonic oscillator (RRHO) approximation. While the details of performing these calculations are well covered in the literature (we direct the interested reader to the Gaussian thermochemistry white paper[42] for a thorough introduction), we will cover some of the details here to shed some light on particular decisions made that affect how we define terms like atomization energy corrections.

To calculate heats of formation, some care is needed, for it usually requires a thermody

\begin{table}
\begin{tabular}{l l} \hline Label & Level of Theory \\ \hline A & \(\omega\)B97M-V/def2-TZVPD \\ B & B3LYP-D3BJ/def2-TZVP \\ C & \(\omega\)B97X-D/def2-TZVP \\ D & DLPNO-CCSD(T)/def2-TZVP // \(\omega\)B97X-D/def2-TZVP \\ E & DLPNO-CCSD(T)-F12/cc-pVDZ-F12 // \(\omega\)B97M-V/def2-TZVPD \\ F & DLPNO-CCSD(T)-F12/cc-pVTZ-F12 // \(\omega\)B97M-V/def2-TZVPD \\ G & BP86/def2-TZVP \\ H & B97D3/def2-TZVP \\ I & TPSS/def2-TZVP \\ J & PBE0/def2-TZVP \\ K & M06-2X/def2-TZVP \\ L & CAM-B3LYP/def2-TZVP \\ M & B2PLYPD/def2-TZVP \\ N & G4 \\ O & CBS-QB3 \\ \hline \end{tabular}
\end{table}
Table 2: Levels of theory used in this work namic cycle (Figure 1) and the mixed-use of values from experiments and QM calculations that usually have different zero of energy references. For a given molecule, "\(M\)", the heat of formation at 298 K, \(\Delta H_{\text{f}}(M,298\,\text{K})\), is defined as the difference in enthalpy between the molecule and its constituents elements in their standard state. Using CH\({}_{4}\) as an example:

\[\Delta H_{\text{f}}(M:=\text{CH}_{4},298\,\text{K})=H_{\text{f}}(\text{CH}_{4}, 298\,\text{K})-H_{\text{f}}(\text{C},\text{graphite},298\,\text{K})-2H_{\text{ f}}(\text{H}_{2},298\,\text{K}) \tag{1}\]

However, single point energies obtained from QM calculation usually have charges separated at infinity and T = 0 K as the zero of energy. Figure 1 shows how this difference in the zero of energy can be resolved to calculate the desired heats of formation \(\Delta H_{\text{f}}(M,298\,\text{K})\). To emphasize the conceptual meaning for each leg of the cycle, we have left out stoichiometric coefficients that serve to balance the number of each type of element for each step to avoid cluttering the figure.

On the left-hand side of Figure 1, we have the desired quantity, \(\Delta H_{\text{f}}(M,298\,\text{K})\), and on the bottom right corner, we have the above-mentioned QM zero of energy. The corrections for

Figure 1: Conceptual diagram outlining the thermodynamic cycle to calculate \(\Delta H_{\text{f}}(M,298K)\) from values that can be computed via quantum chemistry or are known experimentally. \(\Delta H_{\text{f}}(M,298K)\) can be further corrected by applying BACs or IDRs.

temperature effects on enthalpies are simply related by heat capacitiy integrals, and the complexity lies on the calculation of \(\Delta H_{\mathrm{f}}(M,0\,\mathrm{K})\) from QM results. Applying Equation 1 for 0 K reveals that the needed quantities are \(H_{\mathrm{f}}(\mathrm{CH}_{4},0\,\mathrm{K})\), \(H_{\mathrm{f}}(\mathrm{C},\mathrm{graphite},0\,\mathrm{K})\), and \(H_{\mathrm{f}}(\mathrm{H}_{2},0\,\mathrm{K})\). At 0 K, \(H_{\mathrm{f}}(\mathrm{CH}_{4},0\,\mathrm{K})\) is equal to the change in internal energy of the methane molecule (\(M:=\mathrm{CH}_{4}\)) from charges separated at infinity, and this can be calculated as the sum of its single point energy (\(E_{SP}^{M}\)) and zero point energy (\(E_{ZPE}^{M}\)) from QM. To calculate \(H_{\mathrm{f}}(\mathrm{C},\mathrm{graphite},0\,\mathrm{K})\), we need the enthalpy corrections between elements in their reference state (ES) and isolated atoms (\(A\)), i.e., \(\Delta H_{\mathrm{f}}(A:=\mathrm{C},0\,\mathrm{K})=H_{\mathrm{f}}(\mathrm{C}, \mathrm{isolated\ atom},0\,\mathrm{K})-H_{\mathrm{f}}(\mathrm{C},\mathrm{ graphite},0\,\mathrm{K})\). These corrections are usually obtained from experiments and very accurate QM calculations, and their values are well-tabulated with high accuracy.[43] In addition, we need to add the AEC that relates the single point energy of isolated atoms to the QM zero of energy for a chosen level of theory, where AEC is applied to each atom in a molecule. Although we take \(H_{\mathrm{f}}(\mathrm{C},\mathrm{graphite},0\,\mathrm{K})\) as an example, the calculation of \(H_{\mathrm{f}}(\mathrm{H}_{2},0\,\mathrm{K})\) follows the same logic. Combining all the pieces, we can show that for a generic molecule \(M\):

\[\Delta H_{\mathrm{f}}(M,0\,\mathrm{K})=(E_{SP}^{M}+E_{ZPE}^{M})-\sum_{A\in M} \left[AEC-\Delta H_{\mathrm{f}}(A,0\,\mathrm{K})\right] \tag{2}\]

The remaining temperature difference can be accounted by the difference in heat capacities between the elemental states and the molecule from 0 to 298 K:

\[\Delta H_{\mathrm{f}}(M,298\,\mathrm{K})=\Delta H_{\mathrm{f}}(M,0\,\mathrm{K} )+\int_{0}^{298}C_{p}^{M}(T)dT-\int_{0}^{298}C_{p}^{ES}(T)dT \tag{3}\]

We use the experimental heat capacities of the reference elements, and our computed RRHO heat capacities for the molecules. With this, all legs of the cycle are either known experimental quantities or can be calculated from the quantum chemistry output file.

#### Atomization Energy Corrections

Importantly, because the single point energies of isolated atoms from QM calculations often carry substantial and different systematic errors associated with the chosen level of theory, we use fitted AECs for each LOT as a replacement of direct QM calculations for isolated atoms, for we find the AEC approach to be more consistent. In this work, fitting AECs involved a linear least-squares fitting (see equations in SI) to minimize the error in calculating \(\Delta H_{\text{f}}(M,298\,\text{K})\) for a small subset of molecules ranging across all elements: H\({}_{2}\), N\({}_{2}\), O\({}_{2}\), S\({}_{2}\), F\({}_{2}\), Cl\({}_{2}\), Br\({}_{2}\), HF, HCl, HBr, H\({}_{2}\)S, H\({}_{2}\)O, CH\({}_{4}\), NH\({}_{3}\), ClCH\({}_{3}\), and methyl radical. These species are chosen because they have precisely known heats of formation (or by definition exactly known) and are small enough such that the risk of additional errors in calculating any of these species at any LOT is low (e.g., no risk of converging to the wrong conformer). To further minimize errors from the chosen level of theory, experimental geometries and frequencies are used for this fitting. Using these AECs and the procedure shown in Figure 1 allows for calculating \(\Delta H_{\text{f}}(M,298\,\text{K})\) for molecules at the given level of theory with semi-reasonable accuracy. However, significant residual error usually remains if no further corrections, such as bond additivity corrections, are applied.

### Bond Additivity Corrections

In this work we consider two different types of bond additivity corrections: BACs similar to those used by Petersson et al. [7] ("Petersson-type" or "p-BAC"), and those used by Anantharaman and Melius [8] ("Melius-type" or "m-BAC"). In both cases, BAC values are applied per bond as a correction to \(\Delta H_{\text{f}}(M,298\,\text{K})\) with only AECs applied. The BAC parameters are calculated for the 15 LOT examined in the work by fitting to all reference species in the database to minimize errors between the BAC-corrected \(\Delta H_{\text{f}}(M,298\,\text{K})\) and the known experimental values.

**Petersson-Type BACs**

Petersson-type BACs assign a single corrective value for every type of bond present in the 2D representation of the molecule. These bond types are defined pairwise for every combination of elements, including all integer bond orders. For example, common bond types include the carbon-carbon single bond (C-C), the carbon-carbon double bond (C=C), and the carbon-hydrogen bond (C-H). Applying Petersson-type BACs then is just a matter of adding the corresponding corrective value to \(\Delta H_{\text{f}}(M,298\,\text{K})\) for every single instance of all types of bonds in the molecule. For example, Figure 2 shows the process of applying Petersson-type BACs to pyrrole.

Note that because only integer bond orders are considered, this scheme considers pyrrole to be made up of 2 standard C=C bonds and 1 standard C-C bond, even though pyrrole is aromatic. The fact that Petersson-type BACs do not treat aromatic bonds differently nor consider the chemical environment around the bond is potentially a shortcoming, though this trade-off for the sake of simplicity does reduce the number of parameters needed. As an upper bound the number of parameters grows quadratically with the number of elements considered (the scaling is \(3(N+1)\frac{N}{2}\), where \(N\) is the number of elements, and 3 comes from the number of typical bond types in a molecule i.e., single, double, and triple), though the number of parameters needed is less, as not all bond orders are valid between all pairs of

Figure 2: Example application of Petersson-type BACs to a 2D representation of pyrrole for calculating thermo-corrections to \(\Delta H_{\text{f}}(M,298\,\text{K})\). The correction to the molecule is the sum of corrections to each bonds as illustrated.

elements.

### Melius-Type BACs

Anantharaman and Melius developed an alternative formulation for correcting \(\Delta H_{\text{f}}(M,298\,\text{K})\) that incorporates bond distances from the calculated 3D geometry of the molecule and considers information about neighboring atoms. Equation set (4) shows the details of calculating Melius-type BACs. We have adapted our own notation here to help emphasize and distinguish some parameters. For example, variables with subscripts (e.g., \(\alpha_{a}\)) are fitted parameters (with one parameter per element per level of theory), while variables with superscripts (e.g., \(S^{M}\)) are properties of the atoms, bonds, or molecules such as spin and bond distances. \(\xi\) is a fixed parameter of \(3\,\text{\AA}^{-1}\) as recommended by Anantharaman and Melius.

\[\text{BAC}(M)=\sum_{a\in M}\text{Cor}^{\text{atom}}(a)+\sum_{b\in M}\text{Cor} ^{\text{bond}}(b)+\text{Cor}^{\text{molecule}}(M) \tag{4a}\] \[\text{Cor}^{\text{atom}}(a)=\alpha_{a}\] (4b) \[\text{Cor}^{\text{bond}}(\text{bond}(x,y))=\sqrt{\beta_{x}\beta _{y}}\cdot e^{-\xi R^{xy}}+\sum_{w\in N(x)\setminus y}[\gamma_{w}+\gamma_{x}]+ \sum_{z\in N(y)\setminus z}[\gamma_{z}+\gamma_{y}]\] (4c) \[\text{Cor}^{\text{molecule}}(a)=K_{\text{LOT}}\cdot\left(S^{M}- \sum_{a\in M}S^{a}\right) \tag{4d}\]

Equation (4a) shows that Melius-type BACs have three additive correction components for a given molecule \(M\): one for all of its atoms \(a\), one for all of its bonds \(b\), and one based on the molecule as a whole. The atom corrections, given by Equation (4b) apply a single corrective parameter (\(\alpha_{a}\)) based on the element type for atom \(a\). Equation (4c) shows the correction applied to a single bond between atoms \(x\) and \(y\). The first term depends on the bond length, \(R^{xy}\), and fitted parameters \(\beta_{x}\) and \(\beta_{y}\) based on the element types of atoms \(x\) and \(y\). The next two terms in Equation (4c) consider contributions from neighboring atoms (i.e., atoms that are either bonded to \(x\) and \(y\) but excluding both \(x\) and \(y\)), with fitted parameterssuch as \(\gamma_{x}\) based per element. Finally, Equation (4d) considers the spin of the molecule, \(S^{M}\) and the spins of the atoms \(S^{a}\), and includes a fitted parameter \(K_{\text{LOT}}\) that only depends on the level of theory used. Given this, Melius-type BACs require fitting \(3N+1\) parameters for a given level of theory considering \(N\) elements. This is usually smaller than the number of parameters in Petersson-type BAC's. An additional advantage of the Melius-type BACs is that they do not require the bonds to be assigned integer bond-orders, so they are better for molecules with more than one plausible Lewis structure such as aromatics.

Because Equation (4) is non-linear in its fitted parameters, a non-linear least-squares fitting is used to fit these parameters for every level of theory. To do this fitting, ten different randomly-generated initial values for the parameters are employed in each of 10 fits, and the best fit from these attempts is reported here. Each fit uses the least_squares function in scipy.optimize[44] with the Trust Region Reflective method,[45] a 3-point method for calculating the Jacobian, and default numerical convergence criteria.

### Isodesmic Reactions

#### Background

An alternative method to using AECs and BACs for calculating corrected heats of formation is to calculate heats of formation from constructed isodesmic reactions (hypothetical reactions where the number and type of each atom and bond are conserved). Just like using AECs and BACs, this approach also uses data from reference species to reduce the systematic errors from the quantum chemistry calculations at a given level of theory.

Because the discussion below involves nuances among various types of enthalpies that can be quite confusing, we decide to adopt a new set of notations to assist understanding. Specifically, denote \(\Delta_{\text{Y}}^{X}H_{\text{Z}}^{\circ}\), where \(X\) denotes the source of data ("qm" for _ab initio_ calculation, "ref" for accurate reference values, "bac" for BAC-corrected values, "aec" for AEC-corrected values, "iso" for values corrected by isodesmic reaction approach), \(Y\) denotes the type of enthalpy ("f" for formation, "rxn" for reaction), \(Z\) denotes which species the enthalpy represents ("\(t\)" for target species, "\(i\)" for reference species in isodesmic reaction), and finally, \(\circ\) denotes standard state at 298 K. For example, \(\Delta_{\rm f}^{\rm qm}H_{t}^{\circ}\) represents the heat of formation for target species at 298 K calculated from QM.

In the isodesmic approach, a reaction is constructed containing the target species of interest (we take the convention that the target species is a reactant of the reaction) along with any number of reference species as additional reactants and/or products. Both the target (\(t\)) and the included reference species (\(i\)) have uncorrected heats of formation calculated at the same level of theory, \(\Delta_{\rm f}^{\rm qm}H_{t}^{\circ}\) and \(\Delta_{\rm f}^{\rm qm}H_{i}^{\circ}\), respectively. Additionally, reference species have well-known that heats of formation either from experimental data or high-accuracy quantum chemistry calculations, \(\Delta_{\rm f}^{\rm ref}H_{i}^{\circ}\). This is enough information to calculate a value for \(\Delta_{\rm f}^{\rm iso}H_{t}^{\circ}\), which is the heat of formation for the target species from isodesmic reactions that in a sense has been corrected much like \(\Delta_{\rm f}^{\rm bac}H_{t}^{\circ}\).

The rationale for the isodesmic reaction approach is that while quantum chemistry calculations might have systematic errors in calculating heats of formation for a single species, these systematic errors will at least partly cancel when calculating heats of reactions, especially when the number of each bond type is conserved. The assumption of this approach is then that for IDRs, the overall reaction enthalpy computed from individual species enthalpy in the reaction via high-level reference values or QM is approximately the same due to error cancellation, or \(\Delta_{\rm rxn}^{\rm ref}H^{\circ}\approx\Delta_{\rm rxn}^{\rm qm}H^{\circ}\). Because reaction enthalpy can be calculated from individual species enthalpy in the reaction, we can rearrange this approximation to arrive at an equation for the target species, \(\Delta_{\rm f}^{\rm ref}H_{t}^{\circ}\), which is the unknown we want to compute. If the IDR assumption holds, then the calculated \(\Delta_{\rm f}^{\rm ref}H_{t}^{\circ}\) value should be relatively corrected against systematic errors.

\[\Delta_{\rm rxn}^{\rm ref}H^{\circ}=\sum_{\forall i\in{\rm rxn}}\nu_{i} \Delta_{\rm f}^{\rm ref}H_{i}^{\circ} \approx \Delta_{\rm rxn}^{\rm qm}H^{\circ}=\sum_{\forall i\in{\rm rxn}}\nu_ {i}\Delta_{\rm f}^{\rm qm}H_{i}^{\circ} \tag{5a}\] \[\sum_{i\setminus t}\nu_{i}\Delta_{\rm f}^{\rm ref}H_{i}^{\circ}- \Delta_{\rm f}^{\rm ref}H_{t}^{\circ} \approx \sum_{i\setminus t}\nu_{i}\Delta_{\rm f}^{\rm qm}H_{i}^{\circ}- \Delta_{\rm f}^{\rm qm}H_{t}^{\circ}\] (5b) \[\Delta_{\rm f}^{\rm ref}H_{t}^{\circ} \approx \sum_{i\setminus t}\nu_{i}\left[\Delta_{\rm f}^{\rm ref}H_{i}^{ \circ}-\Delta_{\rm f}^{\rm qm}H_{i}^{\circ}\right]+\Delta_{\rm f}^{\rm qm}H_{ t}^{\circ}\] (5c) \[\therefore\Delta_{\rm f}^{\rm iso}H_{t}^{\circ} \equiv \sum_{i\setminus t}\nu_{i}\left[\Delta_{\rm f}^{\rm ref}H_{i}^{ \circ}-\Delta_{\rm f}^{\rm qm}H_{i}^{\circ}\right]+\Delta_{\rm f}^{\rm qm}H_{ t}^{\circ} \tag{5d}\]

Equation (5) shows the calculation scheme starting with the IDR assumption that errors somewhat cancel when calculating heats of reactions to arrive at a value for \(\Delta_{\rm f}^{\rm iso}H_{t}^{\circ}\). Equation (5a) starts with this main assumption, and Equation 5b simply separates out the target species from the remaining reference species of the isodesmic reaction. Equation (5c) rearranges this result to yield an approximate value for the unknown \(\Delta_{\rm f}^{\rm ref}H_{t}^{\circ}\), which Equation (5d) uses to define the calculation for \(\Delta_{\rm f}^{\rm iso}H_{t}^{\circ}\).

A keen observer will note that the summation term in Equation (5d) can be viewed as the corrective term to the calculated heat of formation of the target species, and that this term serves a similar role to applying BACs. This connection in fact runs much deeper. Let us suppose that every species in the isodesmic reaction is composed of a set of definable atom and bond types (could be similar to the bond types of Petersson et al. or more complex), and that there is a systematic error from the quantum chemistry calculation associated with each of these atom and bond types. If the reaction under consideration was an isodesmic reaction with respect to these atom and bond types, then these systematic errors exactly cancel. However, since we have excluded the target species from the summation in Equation (5d), the atom and bond types present in the target molecule have not cancelled. In this way, the summation in Equation (5d) can be viewed as calculating corrections similar to AECs and BACs for the chemical features (e.g., atom type, bond type, rings, charge, multiplicity, etc.) present in the target molecule and then applying these corrections. Consequently, if someone constructs isodesmic reactions by considering the bond types of Petersson et al., then the IDR scheme is mathematically equivalent to applying Petersson-type BACs, albeit with a much smaller training set since usually only a few species are selected to build IDRs.

Given this similarity, it is important to discuss the differences between BACs and IDRs that can affect their performance. As mentioned previously, isodesmic reactions essentially use a much smaller training set to apply what are essentially another form of BACs. One disadvantage is that if a reference species included in the isodesmic reaction has a large uncharacteristic error, this error will affect the final result much more than if a larger reference set was used for training. One way to mitigate this error sensitivity issue is to take an average or median of values obtained from multiple isodesmic reactions. Another method to allow better error cancellation is to choose species that are chemically similar to the target when building IDRs. Finally, constraints could be placed on the species of an isodesmic reaction to ensure that the bonds present in the reaction are similar in nature to each other, and thus should have similar cancellation of errors. These constraints have been employed in the literature, and we adapt them for our workflow.

### Isodesmic reaction classes and constraints

As part of their work developing an implementation to apply isodesmic reactions for correcting thermochemistry calculations, Buerger et al. [13] defined four different classes of isodesmic reactions (labeled RC1 - RC4) of increasing rigor (more likely to result in better cancellation of errors). In this work, we only consider classes RC2-RC4, for RC1 by definition is only an "error-canceling" reaction and not an isodesmic reaction since the number of each bond type is not necessarily conserved in RC1.

RC2 is what is typically thought of as an isodesmic reaction, where only the number and type of each bond is conserved without regard for the surrounding chemical environment. The bond types are equivalent to those defined by Petersson et al. and do not consider aromatic bond types. The next reaction class, RC3, adds the further restriction that the coordinationnumber for each atom on both sides of a bond must also be conserved. The coordination number for the atoms connected by the bond is then used to define a bond feature that separates different types of bonds. Take single C-C bond of ethane as an example, where the carbon atoms on two sides of this bond both have a coordination number of 3 (notice that by convention the carbon-carbon bond in question is excluded from the calculation of coordination number). However, for the single C-C bond in propylene, the \(sp^{3}\) carbon atom has a coordination number of 3 but the other \(sp^{2}\) carbon atom only has a coordination number of 2. Therefore, the C-C single bond of ethane and propylene are treated as different bond types. Finally, RC4 adds the further constraint that the identity of the neighboring atoms (i.e. atoms who are also bonded to at least one of the atoms in the original bond in question), as well as their own coordination numbers must also be conserved. The interested reader should see Buerger et al. [13] for excellent examples and illustrations that make the distinctions between these reaction classes clear.

In this work, we have extended these reaction class definitions into further sub-types to address problems we encountered. For example, because our curated reference set includes anionic, cationic, and even zwitterionic species, we find that these species would often appear in the calculations for non-charged targets. Given that charged species are more likely to have significant errors from QM calculations, it would be better to bias the algorithm to choose neutrals as reference species when possible, especially for neutral targets. To solve this issue, we added the charged-constrained sub-class, which limits included species to have a formal charge no more anionic or cationic than what is present in the target species. Reactions that comply with this constraint are labeled with a subscript "c" (e.g., RC2_c, RC3_c, etc.).

Another potential concern originates from the use of strained cyclic species, especially those with 3- or 4-member rings, as reference molecules, particularly for acyclic target molecules. To address this, we introduced a ring-constrained subclass (e.g., RC2_r). This subclass ensures conservation of the number and type of rings, while the specific atomic identities within the ring are not a priority.

Note that these sub-classes are not mutually exclusive (e.g., RC2_cr exists and constrains both charges and rings). Furthermore, for heightened specificity, we integrated the "scope" subclass (e.g., RC2_s), which omits reference species with features not present in the target molecule. Normally these features are just the bonds defined by the various reaction classes; however, the charge subclass also adds charge as a feature to consider for scope, and the ring subclass adds rings of various sizes as a feature to consider for scope. Because of this, RC2_cs, RC2_rs, and RC2_crs are not the same, as they have different subsets of features they are constraining for scope.

### Automatic Isodesmic Reactions

Among others, a great contribution of Buerger et al. is to show that isodesmic reactions can be found automatically using a computer algorithm, rather than having to be conceived of by hand. Their key insight is that finding isodesmic reaction can be viewed as a constrained optimization problem over the stoichiometric coefficients, \(\nu_{i}\), for the reference species in the reaction. The constraints can ensure that the requirements of the reaction classes are satisfied, while minimizing the objective function determines which of the reference species should be included in the reaction. Given the size of the reference set, there are many different combinations of reference species that could be included while still satisfying the reaction class constraints. Given this, Buerger et al. chose an optimization scheme to try and find an isodesmic reaction that includes the fewest reference species and constraining features. Equation (6) shows the mixed-integer linear programming problem (MILP) defined by Buerger et al. to automatically find isodesmic reactions.

\[\begin{split}\min_{\nu}&\sum_{i}^{N_{\rm ref}} \left[|\nu_{i}|\cdot\sum_{j}^{N_{\rm constraints}}c_{ij}\right]\\ {\rm s.t.}&\sum_{i}^{N_{\rm ref}}\nu_{i}c_{ij}=0 \quad\forall j\in\{1,\ldots,N_{\rm constraints}\},\\ &\nu_{i}>0\quad\forall i\in\{1,\ldots,N_{\rm ref}\}\end{split} \tag{6}\]

In Equation (6), \(\nu_{i}\) are the integer variables being optimized for overall \(N_{\rm ref}\) reference species. \(c_{ij}\) are the number of each constraining feature \(j\) present in reference species \(i\). For example, if \(j\) is the index for a C-H bond in an RC2 scheme and \(i\) is for the reference species methane, \(c_{ij}\) is 4. The constraints of this minimization problem ensure that the conditions of the reaction class are met. We should note that the problem as posed in Equation (6) is not entirely linear in \(\nu_{i}\) given the inclusion of the \(|\nu_{i}|\) term. However, this problem can be recast as a linear problem by assigning separate variables \(\nu_{i}\) when the reference species participates as a reactant rather than a product (while taking care of the proper sign of these variables in the constraints). The minimization procedure ensures that no reference species will participate as both a reactant and a product.

In this work, we implement the algorithm of Buerger et al. as given in Equation 6 in the Arkane software package, along with constraints for the various reaction classes described previously, in order to calculate values for \(\Delta_{\rm f}^{\rm iso}H_{t}^{\circ}\) for a given target species automatically. By default, our implementation takes the median value for \(\Delta_{\rm f}^{\rm iso}H_{t}^{\circ}\) from 10 isodesmic reactions. To solve the MILP, lp_solve[46] is used, although a wrapper to use Pyomo[47, 48] is also implemented. In general, we find lp_solve to be significantly faster most of the time, though it is also prone to occasionally not converging to a solution. As a final implementation note, although any AECs or BACs applied to the reference species and target will ultimately cancel out, \(\Delta_{\rm f}^{\rm qm}H^{\circ}\) does include AECs for both the target and the reference species. This is because the values of \(\Delta_{\rm f}^{\rm qm}H^{\circ}\) for the reference species stored in the database include AECs so that the resulting values are at least somewhat reasonable and close to the reference values.

## Results and Discussion

### Performance of AEC, Petersson- and Melius-type BACs

In order to compare the performance of the different types of BACs, both the training and leave-one-out cross-validation errors are considered for species in the reference set. Figure 3 and Figure 4 shows the distribution of errors for Petersson-type and Melius-type BACs, for all levels of theory described in Table 2, respectively. To better illustrate the effect of different corrections, we also show both the results from applying AECs only (\(\Delta_{\mathrm{f}}^{\mathrm{aec}}H_{t}^{\circ}\), blue) and with BACs also applied (\(\Delta_{\mathrm{f}}^{\mathrm{bac}}H_{t}^{\circ}\), orange).

First, we notice that the distribution of errors with only AEC applied (\(\Delta_{\mathrm{f}}^{\mathrm{aec}}H_{t}^{\circ}\)) is both wider and not centered at zero compared to those with BAC also applied (\(\Delta_{\mathrm{f}}^{\mathrm{bac}}H_{t}^{\circ}\)), indicating that AEC alone often cannot sufficiently correct the large systematic errors commonly seen from QM calculations, and therefore additional corrections such as BAC and IDR are needed. Further, the mean absolute error (MAE) and root mean square error (RMSE) of \(\Delta_{\mathrm{f}}^{\mathrm{aec}}H_{t}^{\circ}\) generally decrease as the level of theory is increased. As expected, we observe that \(\Delta_{\mathrm{f}}^{\mathrm{aec}}H_{t}^{\circ}\) calculated using wave function theory (WFT, e.g., LOT E, F, N, O) generally tends to be more accurate than those calculated using density functional theory (DFT). However, WFTs are substantially more expensive than DFTs, and therefore it is still important to identify DFT methods that can yield reasonable accuracy with lowered computational costs. When comparing different LOTs, it appears that the F12 correction plays an important role in improving accuracy for DLPNO methods (e.g., LOT D vs F). Notably, the \(\omega\)B97M-V/def2-TZVPD DFT (LOT A) yields highly accurate results comparable to WFT methods, albeit at significantly lowered costs, making it an recommended method for calculating enthalpies.

Moreover, the results clearly demonstrate that applying BACs can substantially boost the accuracy of calculated enthalpy values for all LOTs, and especially for DFTs on the lower rungs of the Jacob's ladder. For example, the leave-one-out cross-validation MAEs of Petersson-type BAC-corrected formation enthalpies \(\Delta_{\mathrm{f}}^{\mathrm{p\text{-}bac}}H_{t}^{\circ}\) for all LOTs considered areFigure 3: Distribution of errors in heats of formation before and after applying Petersson-type BACs for 15 LOTs. The RMSE and MAE included are: errors before applying BACs, training errors, and leave-one-out cross-validation errors. Axes are scaled to facilitate comparison across different LOTs. Unscaled version included in the SI.

Figure 4: Distribution of errors in heats of formation before and after applying Melius-type BACs for 15 LOTs. The RMSE and MAE included are: errors before applying BACs, training errors, and leave-one-out cross-validation errors. Axes are scaled to facilitate comparison across different LOTs. Unscaled version included in the SI.

below 2.5 kcal/mol, and are near 2.0 kcal/mol for most DFT methods; further, LOT A, E, F, N, and O all yield near or sub 1.0 kcal/mol accuracy, making them promising candidates to achieve gold-standard thermochemistry. When it comes to the comparison between Melius-type and Petersson-type BACs, we observe similar levels of performance for most of the LOTs, and at first glance, it is not easy to determine which type of BAC generally performs better. We gain some insight, though, by considering both the training and cross-validation errors for these BACs. Table 3 breaks down both training and cross-validation errors at each LOT to facilitate comparison; the table also includes a \(\Delta\) column that shows the difference between these two errors.

As seen in Table 3, Petersson-type BACs almost always have lower training errors (both MAE and RMSE), while Melius-type BACs more often than not have slightly lower cross-validation errors, and m-BACs always have a smaller change in going from training errors to cross-validation errors. This result suggests that Melius-type BACs might generalize better to types of molecules that are not well represented in the reference set, and that Petersson-type BACs are more likely to be undermined by over-fitting, for p-BACs fit a single parameter to a fairly broad notion of a bond type (e.g., treating C-C bonds in benzene and ethane as the same). In unfortunate scenarios, it is therefore possible that Petersson-type BACs are fitted on a training set containing, for example, C-C bonds with substantial chemical differences from the C-C bond in target species, leading to poor performance in real-life tests and applications. Melius-type BACs on the other hand are inherently more flexible in distinguishing between bond types, though a diverse training set is still crucial.

Overall, bond additivity correction is a promising approach to achieve high-quality thermochemistry, and the difference in cross-validation errors between m-BAC and p-BAC is not substantial, especially for higher levels of theory. The possibility of being able to generalize better and requiring slightly fewer parameters does give Melius-type BACs a slight advantage. Moreover, because the cost and performance vary by LOT, a future systemic evaluation and benchmark of more LOTs commonly used in literature for thermochemistry 

[MISSING_PAGE_EMPTY:182]

has the high potential to offer deeper insights into choosing the optimal LOT for different types of chemistry.

### Performance of isodesmic reactions

Analyzing the effectiveness of isodesmic reaction methods requires a more involved approach. For each species \(i\) in the reference set, we can treat the species as if it is a target species and calculate \(\Delta_{\mathrm{f}}^{\mathrm{iso}}H_{i}^{\circ}\) using the remaining species in the reference set (i.e., leave-one-out cross-validation), and then compute the error as \(\Delta_{\mathrm{f}}^{\mathrm{iso}}H_{i}^{\circ}\) - \(\Delta_{\mathrm{f}}^{\mathrm{ref}}H_{i}^{\circ}\) for different LOTs or reaction classes as defined previously.

However, there are two complexities that merit consideration. First, not all species can be calculated using the IDR appraoch. For example, if a certain type of bond or constraint is only found in a small number of species in the reference set, then it may be impossible to construct an isodesmic reaction using only the species in the reference set (excluding the target). This inadequate training set problem becomes increasingly evident for higher-order (i.e., more constrained) reaction classes. The second complexity is that while a certain reaction class might be specified, it is always possible that the median isodesmic reaction used for the final value for \(\Delta_{\mathrm{f}}^{\mathrm{iso}}H^{\circ}\) is also a member of a higher order reaction class. Because of these complexities, we choose to analyze the IDR approach with only LOT A through F, for the main purpose here is to examine the general performance of IDR instead of attempting to fit IDR for all LOTs.

Figures 5, 6, and 7 show errors for each reference species that could be calculated with isodesmic reactions for reaction classes (distinguished by color in the figure) at least as strict as RC2, RC3, and RC4, respectively. Figure 5 shows that although a reaction class as low as RC2 is requested (and thus only RC2 type constraints are considered when using Equation (6), the median reaction found is always a higher order reaction class. In fact, the median reaction is always at least of class RC3 or higher. This is not entirely surprising, as the distinction between RC2 and RC3 is small, with RC3 only considering the aforementioned coordination numbers as additional bond information. Consequently, Figures 5 and 6 look very similar. While the more strict sub-classes are often satisfied as well in both cases, the number of RC4 class reactions found by chance is extremely small, for RC4 reactionsFigure 5: Errors between \(\Delta_{\rm f}^{\rm iso}H^{\circ}\) and known values of \(\Delta_{\rm f}^{\rm ref}H^{\circ}\) using species from the reference set and isodesmic reactions of class RC2 or stricter.

Figure 6: Errors between \(\Delta_{\rm f}^{\rm iso}H^{\circ}\) and known values of \(\Delta_{\rm f}^{\rm ref}H^{\circ}\) using species from the reference set and isodesmic reactions of class RC3 or stricter.

are substantially more restrictive. In fact, Figure 7 shows that only a small portion of the reference species can be calculated using RC4 class reactions or higher. It appears at first glance that the errors associated with RC4 reactions are smaller than either RC2 or RC3, but making this direct comparison is tenuous due to the different populations of species being represented. Species that can be calculated by RC4 reactions are likely well represented in the reference set, which includes a disproportionate number of easier-to-calculate species such as simple alkanes. However, regardless of whether smaller populations provide an advantage, the errors observed from using isodesmic reactions seem considerably greater than the two BAC approach discussed previously. The distribution of errors appears to be wider, and there appear to be more outlier values for isodesmic reactions. Therefore, considering the increased error, coupled with the fact that many species cannot be easily calculated using IDR, the automatic IDR fitting method described so far does not seem advantageous. Yet, we think there are potential remedies that merit further exploration.

We note that the optimization procedure in Equation (6), while capable of finding isodesmic reactions automatically, is set up to prioritize isodesmic reactions that are simple.

Figure 7: Errors between \(\Delta_{\text{f}}^{\text{iso}}H^{\circ}\) and known values of \(\Delta_{\text{f}}^{\text{ref}}H^{\circ}\) using species from the reference set and isodesmic reactions of class RC4 or stricter.

Other than ensuring that the constraints of the reaction class are satisfied, the optimization itself does not attempt to differentiate between isodesmic reactions using some metric of quality, leaving this task entirely up to the reaction classes. As a result, the current procedure does not allow for any further optimization within a reaction class. For instance, one aspect that is worth considering is the data quality of the species included in the isodesmic reaction since some species in the reference set might have a poor geometry at the given level of theory. Buerger et al. were aware of this issue and their solution was to perform a careful prunning of the reference set to remove species that seemed to be inconsistent with the rest of the reference set because these species were considered to have high chances of yielding large error.

Instead of using the approach of Buerger et al., we contemplated embedding a metric to evaluate species data quality directly into the optimization procedure. Our approach thus leads to an optimization procedure designed to minimize the expected errors of the species involved in the isodesmic reaction. One method to gauge the uncertainty of a reference value is to use the difference in the known heat of formation of the reference species with the heat of formation calculated with just AECs at the given level of theory, i.e., \(\Delta_{\mathrm{f}}^{\mathrm{ref}}H_{i}^{\circ}-\Delta_{\mathrm{f}}^{ \mathrm{a}\mathrm{a}\mathrm{e}}H_{i}^{\circ}\). Equation (7) summarizes our approach, which preferentially includes reference species that are well represented by the given LOT while still enforcing the constraints of the reaction class. Since including more species in the isodesmic reaction would only lead to more terms in the objective function, the objective function we defined here should behave similarly to that of Buerger et al. More specifically, optimizing Equation (7) should yield simple IDRs with rewards giving to reactions that have reference species with less uncertainty in enthalpies.

\[\begin{split}\min_{\nu}&\sum_{i}^{N_{\mathrm{ref}}} \left[|\nu_{i}|\cdot|\Delta_{\mathrm{f}}^{\mathrm{ref}}H_{i}^{\circ}-\Delta_{ \mathrm{f}}^{\mathrm{a}\mathrm{e}}H_{i}^{\circ}|\right]\\ \mathrm{s.t.}&\sum_{i}^{N_{\mathrm{ref}}}\nu_{i}c_{ ij}=0\quad\forall j\in\{1,\ldots,N_{\mathrm{constraints}}\},\\ &\nu_{i}>0\quad\forall i\in\{1,\ldots,N_{\mathrm{ref}}\}\end{split} \tag{7}\]Using Equation (7) as the optimization algorithm, Figure 8 shows the resulting errors for using isodesmic reactions of class RC2 and higher.However, it appears that the errors are not significantly different from those achieved in Figure 5 where Equation (6) is used.

The lackluster performance can possibly be attributed to \(|\Delta_{\mathrm{f}}^{\mathrm{ref}}H_{i}^{\circ}-\Delta_{\mathrm{f}}^{\mathrm{ aec}}H_{i}^{\circ}|\) is a poor estimator of the quality of the included reference species (i.e., its expected error at a given level of theory). We note that \(\Delta_{\mathrm{f}}^{\mathrm{aec}}H_{i}^{\circ}\) are simply the heats of formation with AECs applied to them (see the methodology section where we explain this implementation detail), which as we see in Figures 3 and 4 have a wide distribution that usually not centered around zero. Because the errors in \(\Delta_{\mathrm{f}}^{\mathrm{aec}}H_{i}^{\circ}\) does not follow a standard normal distribution, the proposed objective function may favor species at the tail of the distribution to minimize an incorrectly estimated expected error, leading to poor species choices.

Therefore, it is worth considering a different estimator for the quality of the reference species at the given level of theory. The next obvious choice here is to replace \(\Delta_{\mathrm{f}}^{\mathrm{aec}}H_{i}^{\circ}\) with \(\Delta_{\mathrm{f}}^{\mathrm{bac}}H_{i}^{\circ}\), as the errors in heats of formation calculated with BACs are much narrower in distribution, and crucially centered around zero. Equation (8) updates Equation (7) with this

Figure 8: Errors between \(\Delta_{\mathrm{f}}^{\mathrm{iso}}H^{\circ}\) and known values of \(\Delta_{\mathrm{f}}^{\mathrm{ref}}H^{\circ}\) using the optimization algorithm from Equation (7). Isodesmic reactions of class RC2 or stricter were considered.

approach in mind. Note that BAC data is only being used to help us algorithmically favor reference species that are likely well captured at this level of theory. Any BACs applied to the reference species and target would cancel out anyways in an isodesmic reaction approach. Melius-type BACs were chosen for this implementation.

\[\begin{split}\min_{\nu}&\sum_{i}^{N_{\text{ref}}} \left[|\nu_{i}|\cdot|\Delta_{\text{f}}^{\text{ref}}H_{i}^{\circ}-\Delta_{\text {f}}^{\text{bac}}H_{i}^{\circ}|\right]\\ \text{s.t.}&\sum_{i}^{N_{\text{ref}}}\nu_{i}c_{ij}=0 \quad\forall j\in\{1,\ldots,N_{\text{constraints}}\},\\ &\nu_{i}>0\quad\forall i\in\{1,\ldots,N_{\text{ref}}\}\end{split} \tag{8}\]

Figure 9 shows the resulting errors from using the optimization scheme given by Equation (8) for reaction class RC2 or stricter. The distribution of errors given by this approach is much narrower. Furthermore, at a quick glance the errors using this approach appear to be on-par or even slightly better than those obtained through BAC approaches. However, once again we note that this direct comparison is tenuous, for the population of species is not the same because once again this approach could not find isodesmic reactions for all of the

Figure 9: Errors between \(\Delta_{\text{f}}^{\text{iso}}H^{\circ}\) and known values of \(\Delta_{\text{f}}^{\text{ref}}H^{\circ}\) using the optimization algorithm from Equation (8). Isodesmic reactions of class RC2 or stricter were considered.

reference species as explained previously.

To better compare the performance of BAC approaches to this new isodesmic reaction algorithm, we constructed parity plots, where the x-axis is the error from isodesmic reactions while the y-axis is the error from applying Melius-type BACs. Each data point represents a single reference species that was able to be calculated both by BACs and isodesmic reactions. This gets around the issue of separate populations, and allows for a fair comparison between the method. Furthermore, an abundance of points above or below the parity line tells us which method is performing better most of the time. The parity plot comparing cross-validation errors of Melius-type BACs and isodesmic reactions found using Equation (8) can be seen in Figure 10. All of the data correspond to LOT F, and are separated out by the various reactions classes (strictly held, so any RC3 reactions are not also RC4). Comparing these two methods, it appears that the species appear above the parity line (favoring isodesmic reactions) slightly more often than they appear below it (favoring BACs), though this observation is not consistent across all reaction classes. Nonetheless, averaging the errors for BACs and isodesmic reactions for these species yields an advantage of essentially zero, suggesting that both methods are roughly on-par performance-wise. That being said, we are still left with the fact that Melius-type BACs work for all species, which is not true of the isodesmic reaction approach, giving Melius-type BACs a significant advantage.

As a final observation, we note that in Figure 10 the error from isodesmic reactions goes down as the reaction class is increased. Yet, the species that can be predicted using these higher-order reactions classes are also well predicted by using Melius-type BACs. It is unclear if the origin of this phenomena is because being able to use higher order reaction classes means that the target species is well represented in the reference database, which likely also helps Melius-type BACs, or if these well represented species also happen to be species that are better captured by the given level of theory. Either way, it may be possible to predict which species have especially low errors at a given level of theory based on if they can be calculated using a higher order isodesmic reaction scheme.

Figure 10: Parity plots showcasing the performance of isodesmic reactions found from Equation (8) and Melius-type BACs for a given species in the reference set at LOT F. Data points below the parity line indicate that using isodesmic reactions resulted in a lower error for that species than using Melius-type BACs. The BAC advantage is the average difference between using Melius-type BACs versus isodesmic reactions, with a negative value indicating that isodesmic reactions performed better.

## Conclusions

In this work, we implement several approaches for correcting heats of formation obtained through quantum chemistry calculations. Part of this work includes compiling and curating a database (available in the SI) of reference species and thermochemistry data from the literature that contained a diverse set of molecules so that these approaches could be applied to a broad range of molecules. This implementation is available to use with the open-source Arkane software [14], which allows everyone to use these methods and even contribute new parameters for additional levels of theory using the developed application programming interface (API) for fitting parameters and adding new information to the database. Because all of the information needed to fit parameters is stored in the reference species files in the database, it is also possible to replicate our results and regenerate improved corrections.

As for the performance of the various methods, Petersson-type and Melius-type BACs show very similar performance, though Melius-type BACs appear to generalize better. Both approaches are a substantial improvement over just using AECs, though, as previously noted in the literature. By comparison, isodesmic reactions do not appear to perform as well as using BACs, unless care is taken to optimize for including reference species that likely have low errors. In this work, we build on the optimization method of Buerger et al., and demonstrate that the performance of automatic IDR is on-par or slightly better than using BACs even with improved objective functions. Although we did not do so here, it would be interesting to compare our improved automatic IDR approach with the pruning approach used by Buerger et al. to achieve a similar end of preferring certain reference species. While the accuracy of many IDRs are comparable to that of BACs, the isodesmic reaction approaches still have the downside that not all species can be calculated using them, as the reference set needs to include enough high-quality species with relevant chemical features.

With this, in general, we recommend using Melius-type BACs to obtain accurate enthalpies of formation due to its slight advantages. That being said, using Petersson-typeBACs should be viewed as almost equivalent, especially if the target species is well represented in the reference set. Similarly, calculations from isodesmic reactions could also be viewed as almost equivalent if substantial care is taken to choose appropriate reference species, and higher reaction classes are used. Last but not least, given the variance in both cost and performance across different levels of theory, there is a compelling need for a systematic review and benchmarking of enthalpies of formation calculated via LOTs frequently cited in thermochemical literature. Such an effort promises to offer profound insights, guiding researchers in choosing the most suitable LOT for specific chemical contexts, and advancing our progress in efficiently obtaining accurate thermochemical values for a wide variety of molecules.
